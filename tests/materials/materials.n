with matenv; //  Donne accès aux mots clef 'mat' et 'env'

options{
  Bool compatibility_mode=true;
};

materials{ MAT1, MAT2, MAT3};

environments{
  ENV1 { MAT1, MAT2 };
  ENV2 { MAT2 };
  ENV3 { MAT3, MAT1 };
};

cells{
  Real density;
  Real pressure;
  Integer present_material;
  Real mat_density;
};

// WBuild
void buildInit(void) @ -10{}

//WInit
void init(void) @ -10{}

// Initialisation de toutes les mailles
cells void iniCells(void) in (cell density) @ -9{
  density = 1.0;
}

// Initialisation des mailles d'un matériau
cells void iniCellsMat(void) out (cell density) @ -8{
  density = 0.0;
}

environments void iniEnvMatCells(void) out (cell mat_density) @ -7{
  foreach materials
    foreach cell;
}

// Itération directement avec tous les matériaux du gestionnaire
materials void iniMats(void) out (cell mat_density) @ -6{
  foreach cell;
}

// Itération sur tous les milieux et tous les matériaux d'une maille.
environments void iniEnvsMatCell(void) out (cell density)@ -6{
  foreach cell
    foreach material;
}

void compute(void)@1.0{exit;} 
