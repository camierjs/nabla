// NABLA - a Numerical Analysis Based LAnguage

// Copyright (C) 2014 CEA/DAM/DIF
// Jean-Sylvain CAMIER - Jean-Sylvain.Camier@cea.fr

// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
// See the LICENSE file for details.

// ****************************************************************************
// * Calcul min et max des solutions
// ****************************************************************************

own cells Real minCellθ(Real mn){ mn=min(mn,cell_θ); return mn;}
own nodes Real minNodeθ(Real mn){ mn=min(mn,node_θ); return mn;}
void minθ(void) @ 31.0{
  const Real mnθ = mpi_reduce(ReduceMin, min(minCellθ(HUGE_VAL), minNodeθ(HUGE_VAL)));
  info()<<"\t[minθ] minθ="<<mnθ;
}

own cells Real maxCellθ(Real mx){ mx=max(mx,cell_θ); return mx;}
own nodes Real maxNodeθ(Real mx){ mx=max(mx,node_θ); return mx;}
void maxθ(void) @ 31.0{
  const Real mxθ = mpi_reduce(ReduceMax, max(maxCellθ(0.0), maxNodeθ(0.0)));
  info()<<"\t[maxθ] maxθ="<<mxθ;
}
